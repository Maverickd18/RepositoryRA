<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR Personalizado</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <!-- LIBRERIAS LOCALES -->
  <script src="../js/aframe.min.js"></script>
  <script src="../js/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/IdeaSpaceVR/aframe-particle-system-component@1.1.4/dist/aframe-particle-system-component.min.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
    }

    .arjs-loader {
      position: absolute;
      z-index: 999;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Arial', sans-serif;
    }

    .loader-content {
      text-align: center;
    }

    .loader-icon {
      font-size: 3rem;
      margin-bottom: 20px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .loader-text {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .loader-subtext {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.7; }
    }

    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto 0;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>

<div class="arjs-loader" id="loader">
  <div class="loader-content">
    <div class="loader-icon">üëÅÔ∏è</div>
    <div class="loader-text">Cargando Realidad Aumentada...</div>
    <div class="loader-subtext">Preparando c√°mara y marcadores</div>
    <div class="spinner"></div>
  </div>
</div>

<a-scene
  embedded
  vr-mode-ui="enabled: false"
  renderer="logarithmicDepthBuffer: true;"
  arjs="sourceType: webcam; debugUIEnabled: false;"
>

  <!-- ========================================
       MARKER 1: DINOSAURIO CON FUEGO
       ========================================
       IMPORTANTE: Reemplaza "pattern-marker.patt" 
       con tu archivo personalizado, por ejemplo:
       url="../markers/mi-dino-marker.patt"
  -->
  <a-marker
    type="pattern"
    url="../markers/pattern-marker.patt"
    id="marker1"
    smooth="true"
    smoothCount="5"
    emitevents="true"
  >

    <!-- CONTENEDOR DEL DINOSAURIO -->
    <a-entity
      rotation="-90 0 0"
      position="0 0 0"
      animation="property: position;
                 from: -1 0 0;
                 to: 1 0 0;
                 dur: 8000;
                 loop: true;
                 dir: alternate;
                 easing: easeInOutSine"
      animation__rotate="property: rotation;
                         from: -90 0 0;
                         to: -90 360 0;
                         dur: 8000;
                         loop: true;
                         easing: linear"
    >

      <!-- CUERPO -->
      <a-box
        position="0 0.5 0"
        depth="1.6"
        height="0.6"
        width="0.7"
        color="#2E8B57"
      ></a-box>

      <!-- CUELLO -->
      <a-box
        position="0 0.8 -0.6"
        depth="0.7"
        height="0.4"
        width="0.4"
        color="#2E8B57"
      ></a-box>

      <!-- CABEZA (abre y cierra) -->
      <a-box
        position="0 0.95 -1.0"
        depth="0.5"
        height="0.3"
        width="0.4"
        color="#1f5f3a"
        animation="property: rotation;
                   from: 0 0 0;
                   to: 25 0 0;
                   dur: 400;
                   loop: true;
                   dir: alternate"
      ></a-box>

      <!-- FUEGO CON PART√çCULAS üî• -->
      <a-entity
        id="fuego"
        position="0 0.95 -1.35"
        particle-system="
          preset: dust;
          color: #ff4500,#ffae00,#ffff00;
          particleCount: 200;
          size: 0.25;
          velocityValue: 0 0 -6;
          accelerationValue: 0 -1 0;
          direction: -1;
          lifetime: 1;
          blending: additive"
        visible="false"
      ></a-entity>

      <!-- OJO -->
      <a-sphere
        position="0.15 1 -1.2"
        radius="0.05"
        color="black"
      ></a-sphere>

      <!-- COLA -->
      <a-cone
        position="0 0.6 1"
        radius-bottom="0.4"
        radius-top="0.05"
        height="1"
        color="#2E8B57"
        rotation="0 0 180"
        animation="property: rotation;
                   to: 0 25 180;
                   loop: true;
                   dur: 600;
                   dir: alternate"
      ></a-cone>

    </a-entity>

  </a-marker>


  <!-- ========================================
       MARKER 2: SISTEMA SOLAR
       ========================================
       IMPORTANTE: Reemplaza con tu marcador personalizado
       Ejemplo: url="../markers/mi-sistema-solar.patt"
       
       Nota: Eliminamos preset="hiro" para usar patr√≥n personalizado
  -->
  <a-marker 
    type="pattern"
    url="../markers/angriber.patt"
    id="marker2"
    smooth="true"
    smoothCount="5"
  >

    <!-- SOL -->
    <a-sphere 
      color="yellow" 
      radius="0.25" 
      position="0 0.5 0"
      animation="property: scale; 
                 to: 1.1 1.1 1.1; 
                 dir: alternate; 
                 loop: true; 
                 dur: 800"
    ></a-sphere>

    <!-- √ìRBITA 1 - Planeta Azul -->
    <a-torus
      radius="0.6"
      radius-tubular="0.008"
      color="white"
      rotation="90 0 0"
      opacity="0.5"
    ></a-torus>

    <a-entity 
      animation="property: rotation; 
                 to: 0 360 0; 
                 loop: true; 
                 dur: 3000; 
                 easing: linear"
    >
      <a-sphere 
        color="blue" 
        radius="0.07" 
        position="0.6 0.5 0"
      ></a-sphere>
    </a-entity>

    <!-- √ìRBITA 2 - Planeta Rojo -->
    <a-torus
      radius="0.9"
      radius-tubular="0.008"
      color="white"
      rotation="90 0 0"
      opacity="0.5"
    ></a-torus>

    <a-entity 
      animation="property: rotation; 
                 to: 0 -360 0; 
                 loop: true; 
                 dur: 5000; 
                 easing: linear"
    >
      <a-sphere 
        color="red" 
        radius="0.09" 
        position="0.9 0.5 0"
      ></a-sphere>
    </a-entity>

    <!-- √ìRBITA 3 - Planeta Morado -->
    <a-torus
      radius="1.2"
      radius-tubular="0.008"
      color="white"
      rotation="90 0 0"
      opacity="0.5"
    ></a-torus>

    <a-entity 
      animation="property: rotation; 
                 to: 0 360 0; 
                 loop: true; 
                 dur: 7000; 
                 easing: linear"
    >
      <a-sphere 
        color="purple" 
        radius="0.1" 
        position="1.2 0.5 0"
      ></a-sphere>
    </a-entity>

  </a-marker>


  <!-- MARKER 3: TEXTO - Usa marcador KANJI predeterminado -->
  <a-marker 
    preset="kanji"
    id="marker3"
    smooth="true"
    smoothCount="5"
  >
    <!-- CALABAZA 3D ANIMADA -->
    <a-sphere
      color="#FF6347"
      radius="0.3"
      position="0 0.5 0"
      animation="property: scale;
                 to: 1.2 1.2 1.2;
                 dur: 1000;
                 loop: true;
                 dir: alternate;
                 easing: easeInOutSine"
    ></a-sphere>

    <!-- OJO IZQUIERDO -->
    <a-triangle
      color="black"
      vertex-a="0 0.15 0"
      vertex-b="-0.08 0.08 0"
      vertex-c="-0.08 0.15 0"
      position="-0.1 0.55 0.25"
      rotation="0 0 0"
    ></a-triangle>

    <!-- OJO DERECHO -->
    <a-triangle
      color="black"
      vertex-a="0 0.15 0"
      vertex-b="0.08 0.08 0"
      vertex-c="0.08 0.15 0"
      position="0.1 0.55 0.25"
      rotation="0 0 0"
    ></a-triangle>

    <!-- BOCA -->
    <a-box
      color="black"
      width="0.15"
      height="0.05"
      depth="0.05"
      position="0 0.4 0.25"
    ></a-box>

    <!-- TALLO -->
    <a-cylinder
      color="#228B22"
      radius="0.05"
      height="0.15"
      position="0 0.85 0"
    ></a-cylinder>
  </a-marker>
  <a-marker
  type="pattern"
  url="../markers/pattern-pattern-pumpkin.patt"
  id="pumpkinMarker"
  smooth="true"
  smoothCount="5"
>
  <a-image
    src="../icon/pumpkin.png"
    position="0 0 0"
    rotation="-90 0 0"
    width="1"
    height="1"
  ></a-image>
</a-marker>


  <a-entity camera></a-entity>
</a-scene>

<!-- Script para el dinosaurio -->
<script>
  const marker1 = document.querySelector("#marker1");
  const fuego = document.querySelector("#fuego");

  if (marker1 && fuego) {
    marker1.addEventListener("markerFound", () => {
      console.log("¬°Marcador 1 (Dinosaurio) detectado!");
      fuego.setAttribute("visible", true);
    });

    marker1.addEventListener("markerLost", () => {
      console.log("Marcador 1 perdido");
      fuego.setAttribute("visible", false);
    });
  }

  // Logs para debugging
  const marker2 = document.querySelector("#marker2");
  const marker3 = document.querySelector("#marker3");

  if (marker2) {
    marker2.addEventListener("markerFound", () => {
      console.log("¬°Marcador 2 (Sistema Solar) detectado!");
    });
  }

  if (marker3) {
    marker3.addEventListener("markerFound", () => {
      console.log("¬°Marcador 3 (Texto) detectado!");
    });
  }
</script>

<!-- Ocultar loader despu√©s de cargar -->
<script>
  window.addEventListener('load', () => {
    setTimeout(() => {
      const loader = document.getElementById('loader');
      if (loader) {
        loader.style.opacity = '0';
        loader.style.transition = 'opacity 0.5s ease';
        setTimeout(() => {
          loader.style.display = 'none';
        }, 500);
      }
    }, 2000);
  });
</script>

</body>
</html>