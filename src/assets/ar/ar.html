<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <!-- LIBRERIAS LOCALES -->
  <script src="../js/aframe.min.js"></script>
  <script src="../js/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/IdeaSpaceVR/aframe-particle-system-component@1.1.4/dist/aframe-particle-system-component.min.js"></script>


  <style>
    body {
      margin: 0;
      overflow: hidden;
    }

    .arjs-loader {
      position: absolute;
      z-index: 999;
      background: black;
      color: white;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.3rem;
    }
  </style>
</head>

<body>

<div class="arjs-loader" id="loader">
  Cargando Realidad Aumentada...
</div>

<a-scene
  embedded
  vr-mode-ui="enabled: false"
  renderer="logarithmicDepthBuffer: true;"
  arjs="sourceType: webcam; debugUIEnabled: false;"
  sound="autoplay: true"
>

  <!-- MARKER 1 (.patt) -->
<a-marker
  type="pattern"
  url="../markers/pattern-marker.patt"
  id="marker1"
  smooth="true"
  smoothCount="5"
  emitevents="true"
>

  <!-- CONTENEDOR DEL DINOSAURIO (lo pone horizontal y lo mueve) -->
<a-entity
  rotation="-90 0 0"
  position="0 0 0"

  animation="property: position;
             from: -1 0 0;
             to: 1 0 0;
             dur: 8000;
             loop: true;
             dir: alternate;
             easing: easeInOutSine"

  animation__rotate="property: rotation;
                     from: -90 0 0;
                     to: -90 360 0;
                     dur: 8000;
                     loop: true;
                     easing: linear"
>

    <!-- CUERPO -->
    <a-box
      position="0 0.5 0"
      depth="1.6"
      height="0.6"
      width="0.7"
      color="#2E8B57"
    ></a-box>

    <!-- CUELLO -->
    <a-box
      position="0 0.8 -0.6"
      depth="0.7"
      height="0.4"
      width="0.4"
      color="#2E8B57"
    ></a-box>

    <!-- CABEZA (abre y cierra) -->
    <a-box
      position="0 0.95 -1.0"
      depth="0.5"
      height="0.3"
      width="0.4"
      color="#1f5f3a"
      animation="property: rotation;
                 from: 0 0 0;
                 to: 25 0 0;
                 dur: 400;
                 loop: true;
                 dir: alternate"
    ></a-box>

<!-- FUEGO PRO (PARTÃCULAS) ðŸ”¥ -->
<a-entity
  id="fuego"
  position="0 0.95 -1.35"
  particle-system="
    preset: dust;
    color: #ff4500,#ffae00,#ffff00;
    particleCount: 200;
    size: 0.25;
    velocityValue: 0 0 -6;
    accelerationValue: 0 -1 0;
    direction: -1;
    lifetime: 1;
    blending: additive"
  visible="false"
></a-entity>



    <!-- OJO -->
    <a-sphere
      position="0.15 1 -1.2"
      radius="0.05"
      color="black"
    ></a-sphere>

    <!-- COLA -->
    <a-cone
      position="0 0.6 1"
      radius-bottom="0.4"
      radius-top="0.05"
      height="1"
      color="#2E8B57"
      rotation="0 0 180"
      animation="property: rotation;
                 to: 0 25 180;
                 loop: true;
                 dur: 600;
                 dir: alternate"
    ></a-cone>

  </a-entity>

</a-marker>


<!-- MARKER 2 (HIRO) - SISTEMA SOLAR -->
<a-marker preset="hiro" id="marker2">

  <!-- SOL -->
  <a-sphere 
    color="yellow" 
    radius="0.25" 
    position="0 0.5 0"
    animation="property: scale; to: 1.1 1.1 1.1; dir: alternate; loop: true; dur: 800"
  ></a-sphere>

  <!-- Ã“RBITA 1 -->
  <a-torus
    radius="0.6"
    radius-tubular="0.008"
    color="white"
    rotation="90 0 0"
  ></a-torus>

  <a-entity animation="property: rotation; to: 0 360 0; loop: true; dur: 3000; easing: linear">
    <a-sphere 
      color="blue" 
      radius="0.07" 
      position="0.6 0.5 0"
    ></a-sphere>
  </a-entity>

  <!-- Ã“RBITA 2 -->
  <a-torus
    radius="0.9"
    radius-tubular="0.008"
    color="white"
    rotation="90 0 0"
  ></a-torus>

  <a-entity animation="property: rotation; to: 0 -360 0; loop: true; dur: 5000; easing: linear">
    <a-sphere 
      color="red" 
      radius="0.09" 
      position="0.9 0.5 0"
    ></a-sphere>
  </a-entity>

  <!-- Ã“RBITA 3 -->
  <a-torus
    radius="1.2"
    radius-tubular="0.008"
    color="white"
    rotation="90 0 0"
  ></a-torus>

  <a-entity animation="property: rotation; to: 0 360 0; loop: true; dur: 7000; easing: linear">
    <a-sphere 
      color="purple" 
      radius="0.1" 
      position="1.2 0.5 0"
    ></a-sphere>
  </a-entity>

</a-marker>


  <!-- MARKER 3 (KANJI) -->
  <a-marker preset="kanji" id="marker3">
    <a-text
      value="FUNCIONA"
      align="center"
      color="yellow"
      position="0 0.5 0"
      scale="2 2 2"
    ></a-text>
  </a-marker>

  <a-entity camera></a-entity>
</a-scene>

<script>
  const marker = document.querySelector("#marker1");
  const sonido = document.querySelector("#dinoSound");
  const fuego = document.querySelector("#fuego");

  marker.addEventListener("markerFound", () => {
    sonido.currentTime = 0;
    sonido.play();
    fuego.setAttribute("visible", true);
  });

  marker.addEventListener("markerLost", () => {
    sonido.pause();
    fuego.setAttribute("visible", false);
  });
</script>



<script>
  window.addEventListener('load', () => {
    setTimeout(() => {
      const loader = document.getElementById('loader')
      if (loader) loader.style.display = 'none'
    }, 2000)
  })
</script>

</body>
</html>
